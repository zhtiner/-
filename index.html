<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>🥜花生 - How to Cost Your Life</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+SC:wght@300;400;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- html2pdf for export PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

  <!-- html2canvas for share image -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app" id="app">
    <!-- Top bar -->
    <header class="topbar">
      <div class="title">🥜花生 – How to Cost Your Life</div>
      <div class="top-actions">
        <button id="btn-scan-pay" title="模拟支付" class="icon-btn"><i class="ri-wallet-3-line"></i></button>
        <button id="btn-report" title="生成报告" class="icon-btn"><i class="ri-file-chart-line"></i></button>
      </div>
    </header>

    <!-- Pages -->
    <main class="main">
      <!-- Home / Stream -->
      <section id="page-home" class="page active">
        <div class="home-header">
          <div class="budget-overview" id="budget-overview">
            <!-- Budget progress bars render here -->
          </div>
          <div class="view-controls">
            <div class="filters">
              <select id="filter-category"><option value="all">全部分类</option></select>
              <select id="filter-sort">
                <option value="desc">按时间倒序</option>
                <option value="asc">按时间正序</option>
              </select>
              <select id="filter-range">
                <option value="all">全部时间</option>
                <option value="7">最近7天</option>
                <option value="30">最近30天</option>
                <option value="month">本月</option>
              </select>
            </div>
            <div class="view-toggle">
              <button id="toggle-flow" class="btn-toggle active" title="动态流"><i class="ri-flow-chart"></i></button>
              <button id="toggle-album" class="btn-toggle" title="相册视图"><i class="ri-gallery-line"></i></button>
            </div>
          </div>
        </div>

        <div id="warning-banner" class="warning-banner hidden"></div>

        <div id="entries-list" class="entries-list dynamic"></div>
      </section>

      <!-- Add / Record -->
      <section id="page-add" class="page">
        <form id="entry-form" class="entry-form">
          <div class="form-row">
            <label>金额</label>
            <input type="number" step="0.01" min="0" id="input-amount" placeholder="¥0.00" required>
          </div>
          <div class="form-row">
            <label>分类</label>
            <select id="input-category"></select>
            <button id="btn-edit-budgets" type="button" class="small">预算</button>
          </div>
          <div class="form-row half">
            <label>日期</label>
            <input type="datetime-local" id="input-datetime">
          </div>
          <div class="form-row half">
            <label>心情</label>
            <select id="input-mood">
              <option value="">无</option>
              <option>开心</option>
              <option>治愈</option>
              <option>解压</option>
              <option>审慎</option>
            </select>
          </div>
          <div class="form-row">
            <label>备注</label>
            <input id="input-note" placeholder="写点什么...">
          </div>
          <div class="form-row">
            <label>上传照片</label>
            <input type="file" accept="image/*" id="input-photo">
            <div id="photo-preview" class="photo-preview"></div>
          </div>

          <div class="form-actions">
            <button type="submit" class="primary">保存记账</button>
            <button id="btn-sim-pay" type="button" class="secondary">去支付（模拟）</button>
          </div>
        </form>
      </section>

      <!-- Stats -->
      <section id="page-stats" class="page">
        <div class="stats-controls">
          <select id="stats-range">
            <option value="7">7天</option>
            <option value="30" selected>30天</option>
            <option value="month">本月</option>
          </select>
          <button id="stats-toggle-chart" class="small">切换图表</button>
        </div>

        <div class="charts">
          <div class="chart-card">
            <h3>分类支出占比</h3>
            <canvas id="chart-pie" height="220"></canvas>
          </div>
          <div class="chart-card">
            <h3 id="trend-title">最近30天趋势</h3>
            <canvas id="chart-trend" height="220"></canvas>
          </div>
        </div>

        <div class="summary" id="monthly-summary"></div>
      </section>

      <!-- Settings -->
      <section id="page-settings" class="page">
        <h3>设置 & 预算管理</h3>
        <div id="budgets-editor" class="budgets-editor"></div>

        <h3>导出 & 分享</h3>
        <div class="settings-actions">
          <button id="btn-export-pdf" class="primary">导出当月报告为 PDF</button>
          <button id="btn-clear-data" class="danger">清空所有数据（示例数据将回归）</button>
        </div>

        <h3>扩展</h3>
        <p>模拟支付 / 社交分享集成示例（微信/支付宝/H5 & 小红书链接复制）</p>
      </section>
    </main>

    <!-- Modal image -->
    <div id="image-modal" class="image-modal hidden" tabindex="-1">
      <div class="image-modal-inner">
        <button id="close-image-modal" class="close"><i class="ri-close-line"></i></button>
        <img id="image-modal-img" src="" alt="预览">
      </div>
    </div>

    <!-- Bottom Nav -->
    <nav class="bottom-nav">
      <button class="nav-btn active" data-page="page-home"><i class="ri-home-4-line"></i><span>首页</span></button>
      <button class="nav-btn" data-page="page-add"><i class="ri-add-circle-line"></i><span>记录</span></button>
      <button class="nav-btn" data-page="page-stats"><i class="ri-bar-chart-line"></i><span>统计</span></button>
      <button class="nav-btn" data-page="page-settings"><i class="ri-settings-3-line"></i><span>设置</span></button>
    </nav>

    <!-- Share / Report card hidden -->
    <div id="share-card" class="share-card hidden" aria-hidden="true"></div>
  </div>

  <script src="script.js"></script>
</body>
</html>
